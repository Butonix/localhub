{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/activity_base.html" %}

{% load i18n %}
{% load rules %}

{% block content %}
{% include "activities/includes/description.html" %}

{% has_perm "polls.vote" user object as can_vote %}
<ol class="poll-answers">
    {% for answer in object.answers.all %}
    <li>{{ answer }}
        <meter class="meter"
               value="{% widthratio answer.num_votes object.total_num_votes 100 %}"
               title="{% blocktrans count counter=answer.num_votes %}1 vote{% plural %}{{ counter }} votes{% endblocktrans %}"
               min="0"
               max="100"></meter>
        {% if can_vote %}
        <a class="d-hide"
           data-controller="js-toggle ajax"
           data-action="ajax#post"
           href="{% url 'polls:vote' answer.id %}">{% trans "Vote" %}</a>
        {% endif %}
    </li>
    {% endfor %}
</ol>

{% if object.total_num_votes %}
<p class="pt-1">
    {% blocktrans count counter=object.total_num_votes %}
    One person has voted.
    {% plural %}
    <b>{{ counter }}</b> people have voted.
    {% endblocktrans %}
</p>
{% endif %}

{% endblock content %}