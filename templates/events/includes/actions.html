{# Copyright (c) 2020 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/includes/actions.html" %}

{% load i18n %}
{% load rules %}

{% block extra_actions %}

{% has_perm "events.attend" user object as can_attend %}

{% if can_attend %}
<div data-controller="ajax">
  <a href="{% url 'events:unattend' object.id %}"
     data-turbolinks="false"
     class="dropdown-menu-item line-through{% if not object.is_attending %} hidden{% endif %}"
     data-target="ajax.toggle ajax.button"
     data-action="ajax#post">{% trans "Attending" %}</a>
  <a href="{% url 'events:attend' object.id %}"
     data-turbolinks="false"
     class="dropdown-menu-item{% if object.is_attending %} hidden{% endif %}"
     data-target="ajax.toggle ajax.button"
     data-action="ajax#post">{% trans "Attending" %}</a>
</div>
{% endif %}

{% if object.is_attendable %}
<a href="{% url 'events:download' object.id %}"
   class="dropdown-menu-item"
   data-turbolinks="false"
   download>
  {% trans 'Download' %}
</a>
{% endif %}

{% has_perm "events.cancel" user object as can_cancel %}
{% if can_cancel %}
<a href="{% url 'events:cancel' object.id %}"
   class="dropdown-menu-item"
   data-controller="ajax"
   data-action="ajax#post"
   {% if not is_detail %}
   data-ajax-redirect="{{ request.get_full_path }}"
   {% endif %}
   data-ajax-confirm-header="{% trans 'Cancel' %}"
   data-ajax-confirm-body="{% trans 'Are you sure you want to cancel this event?' %}">
  {% trans "Cancel Event" %}</a>
{% endif %}


{% endblock %}
