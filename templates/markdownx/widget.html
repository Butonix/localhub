{# Copyright (c) 2020 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% load i18n %}
{% load static %}

<div class="markdownx"
     data-controller="tabs typeahead"
     data-tabs-active-class="bg-gray-800 text-white border-t border-r border-l border-gray-800"
     data-tabs-inactive-class="hover:bg-gray-700 hover:text-white"
     data-typeahead-config="{{ typeahead_config }}">
  <div class="flex flex-wrap items-center text-sm border-b border-gray-500 mb-2">
    <button class="mr-2 p-1 px-2 lg:px-5"
            type="button"
            data-target="tabs.tab"
            data-action="tabs#select"
            data-tab="editor">{% trans "Edit" %}</button>
    <button class="mr-2 p-1 px-2 lg:px-5"
            type="button"
            data-target="tabs.tab"
            data-action="tabs#select"
            data-tab="preview">{% trans "Preview" %}</button>
    <button class="p-1 px-2 lg:px-5"
            type="button"
            data-target="tabs.tab"
            data-action="tabs#select"
            data-tab="guide">
      {% trans "Hints" %}</button>
  </div>
  <div class="-mb-px mb-2"
       data-target="tabs.pane"
       data-tab="editor"
       data-controller="markdown">
    <div class="text-xs flex flex-wrap items-center mb-2">

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-markdown="**[SELECTION]**">{% trans "Bold" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-markdown="_[SELECTION]_">{% trans "Italic" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-markdown="[[SELECTION]](url)">{% trans "Link" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-markdown="![]([SELECTION])">{% trans "Image" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-markdown="> [SELECTION]">{% trans "Quote" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-markdown="`[SELECTION]`">{% trans "Code" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-multiline
         data-markdown="* [SELECTION]">{% trans "List (Bullets)" %}</a>

      <a href="#"
         class="inline-block mr-2 text-blue-800 hover:text-blue-700"
         data-action="markdown#select"
         data-multiline
         data-markdown="1. [SELECTION]">{% trans "List (Numbers)" %}</a>

      <div class=""
           data-controller="dropdown"
           data-dropdown-toggle-class="hidden"
           data-action="click@window->dropdown#close keydown@window->dropdown#close">
        <button class="border border-gray-800 p-1 px-2 hover:bg-gray-100 focus:bg-gray-100"
                type="button"
                data-action="dropdown#toggle">
          {% trans "Emoji..." %}
        </button>
        <ul class="hidden absolute bg-gray-100 mt-3 p-2 overflow-y-scroll h-32 border border-gray-800"
            data-target="dropdown.menu">
          {% common_emojis as emoji_categories %}
          {% for category in emoji_categories %}
          <li class="border-b border-gray-800 pb-1 {% if not forloop.first %} mt-3{% endif %} font-semibold">{{ category.name }}</li>
          {% for emoji in category.emojis %}
          <li class="my-1">
            <a href="#"
               class="flex items-center"
               data-action="markdown#select"
               data-markdown="[SELECTION] {{ emoji.markdown }} ">
              <img src="{% static emoji.image %}"
                   loading="lazy"
                   height="16"
                   width="16"
                   class="inline-block mr-2">
              <span class="inline-block">
                {{ emoji.label }}
              </span>
            </a>
          </li>
          {% endfor %}
          {% endfor %}
        </ul>
      </div>

    </div>
    <ul class="typeahead-selector hidden"
        data-target="typeahead.selector"></ul>
    <textarea data-controller="autoresize"
              data-target="markdown.textarea typeahead.input"
              data-action="keyup->autoresize#resize keyup->typeahead#keyup keydown->typeahead#keydown"
              name="{{ widget.name }}"
              {% include "django/forms/widgets/attrs.html" %}>{% spaceless %}{% if widget.value %}{{ widget.value }}{% endif %}{% endspaceless %}</textarea>
    <p class="text-sm text-gray-700">
      You can use <a target="_blank"
         rel="nofollow"
         href="https://www.markdownguide.org/basic-syntax">Markdown</a> to format your content.
    </p>
  </div>
  <div class="hidden markdownx-preview"
       data-target="tabs.pane"
       data-tab="preview"></div>
  <div class="hidden"
       data-target="tabs.pane"
       data-tab="guide">
    <table class="table-auto text-sm">
      <tbody>
        <tr>
          <td># Header</td>
          <td>
            <h1>{% trans "Header (h1)" %}</h1>
          </td>
        </tr>
        <tr class="bg-gray-100">
          <td>## Header</td>
          <td>
            <h2>{% trans "Header (h2)" %}</h2>
          </td>
        </tr>
        <tr>
          <td>### Header</td>
          <td>
            <h3>{% trans "Header (h3)" %}</h3>
          </td>
        </tr>
        <tr class="bg-gray-100">
          <td>*Bold*</td>
          <td><strong>{% trans "Bold" %}</strong></td>
        </tr>
        <tr>
          <td>_Italic_</td>
          <td><em>{% trans "Italic" %}</em></td>
        </tr>
        <tr class="bg-gray-100">
          <td>[Link text](http://example.com)</td>
          <td><a href="#">{% trans "Link" %}</a></td>
        </tr>
        <tr>
          <td>![alt](https://example.com)</td>
          <td>
            {% trans "Image" %}
            <br>
            <b>{% trans "Note: only safe images (starting with https://) will be shown." %}</b>
          </td>
        </tr>
        <tr class="bg-gray-100">
          <td>@mention</td>
          <td><a href="#">@mention</a> {% trans "(link to profile)" %}</td>
        </tr>
        <tr>
          <td>#hashtag</td>
          <td><a href="#">#hashtag</a> {% trans "(link to hashtag)" %}</td>
        </tr>
        <tr class="bg-gray-100">
          <td>`Code`</td>
          <td><code>{% trans "Code" %}</code></td>
        </tr>
        <tr>
          <td>&gt; Quote</td>
          <td>
            <blockquote>{% trans "Quote" %}</blockquote>
          </td>
        </tr>
        <tr class="bg-gray-100">
          <td>
            * List item 1 <br>
            * List item 2
          </td>
          <td>
            <ul>
              <li>List item 1</li>
              <li>List item 2</li>
            </ul>
          </td>
        </tr>
        <tr>
          <td>
            1. List item 1 <br>
            1. List item 2
          </td>
          <td>
            <ol>
              <li>List item 1</li>
              <li>List item 2</li>
            </ol>
          </td>
        </tr>
        <tr class="bg-gray-100">
          <td colspan="2">
            {% blocktrans %}
            <a target="_blank"
               rel="nofollow"
               href="https://www.markdownguide.org/basic-syntax">Markdown Guide</a>
        </tr>
        <tr>
          <td colspan="2">
            <a target="_blank"
               rel="nofollow"
               href="https://gist.github.com/rxaviers/7360908">Emoji Markdown Symbols</a>
            {% endblocktrans %}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
