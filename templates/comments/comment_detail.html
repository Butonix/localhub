{% extends "activities/base.html" %}

{% load i18n %}
{% load rules %}

{% block activities_content %}

{% has_perm "comments.change_comment" user comment as can_change_comment %}
{% has_perm "comments.delete_comment" user comment as can_delete_comment %}
{% has_perm "comments.like_comment" user comment as can_like_comment %}

<div class="card comment-card">
  <div class="card-header">
    <div class="card-subtitle text-gray float-right">
      {% blocktrans with comment.created|timesince as created %}{{ created }} ago{% endblocktrans %}
    </div>
    <div class="card-title"><a href="{{ comment.post.get_absolute_url }}">{% trans "Parent" %}</div>
    <div class="card-subtitle h6"><a href="{{ comment.owner.get_profile_url }}">{{ comment.owner.username }}</a></div>
  </div>
  <div class="card-body">
    <div class="divider"></div>
    {{ comment.markdown }}
  </div>
  <div class="card-footer">
    <div class="divider"></div>

    <div class="d-flex content-actions">

      {% if comment.owner_id == user.id and comment.num_likes %}
      <div class="mr-2">{% trans "Likes" %} ({{ comment.num_likes }})</div>
      {% elif can_like_comment %}
      <div class="mr-2">
        <a href="#"
           data-controller="ajax"
           data-ajax-url=""
           data-ajax-replace="true"
          >{% trans "Like" %}</a>
      </div>
      {% endif %}


      <!--
      <div class="mr-2">
        <a href="">{% trans "Flag" %}</a>
      </div>
      -->


      {% if can_change_comment %}
      <div class="mr-2">
          <a href="{% url 'comments:update' comment.id %}"
           >{% trans "Update" %}</a>
      </div>
      {% endif %}

      {% if can_change_comment %}
      <div class="mr-2">
        {% url "comments:delete" comment.id as delete_url %}
        <a href="{{ delete_url }}"
           data-controller="ajax confirm"
           data-action="confirm#check ajax#delete"
           data-ajax-url="{{ delete_url }}"
           data-confirm-header="{% trans 'Delete Comment' %}"
           data-confirm-body="{% trans 'Are you sure you want to delete this comment?' %}"
           >{% trans "Delete" %}</a>
      </div>
      {% endif %}

      <div class="">
        <a href="{{ comment.get_permalink }}">{% trans "Permalink" %}</a>
      </div>
    </div>
  </div>

</div>
{% endblock activities_content %}
