{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "messageboard/base.html" %}

{% load i18n %}

{% block messageboard_content %}

{% if paginator.count %}
{% include "includes/search_form.html" %}
{% endif %}

<p class="toast text-center my-1">
  {% url 'user_update' as user_settings_url %}
  {% blocktrans %}You can enable emails for new messages <a href="{{ user_settings_url }}">in your settings</a>.{% endblocktrans %}
</p>

{% if object_list %}
{% regroup object_list by get_month as months %}

<div class="timeline">
  {% for month in months %}
  <div class="timeline-item">
    <div class="timeline-left">
      <a class="timeline-icon" href="#"></a>
    </div>
    <div class="timeline-content">
      <div class="tile">
        <div class="tile-content">
          <p class="tile-subtitle">{{ month.grouper }}</p>
          {% for recipient in month.list %}
          <p class="tile-title">
            <a href="{{ recipient.get_absolute_url }}">
              {% if not recipient.read %}<strong>{% endif %}
                {{ recipient.message.subject }}
                {% if not recipient.read %}</strong>{% endif %}
            </a><br>
            {% include "users/includes/chip.html" with profile=recipient.message.sender %}
            <span class="text-gray">{{ recipient.message.created|date:"DATETIME_FORMAT" }}</span>
          </p>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% include "includes/pagination.html" %}
{% else %}
<div class="empty">
  <p class="empty-title h5">{% trans "Your inbox is empty" %}</p>
</div>
{% endif %}
{% endblock messageboard_content %}


