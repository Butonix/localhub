{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "conversations/message_list_base.html" %}

{% load i18n %}

{% block message_list %}

{% if paginator.count or view.search_query %}
{% include "includes/search_form.html" %}
{% endif %}

{% include "conversations/email_settings.html" %}

{% if object_list %}
{% for message in object_list %}
<div class="card">
  <div class="card-header">
    <div class="card-title h6">
      {# TBD: move this to the general includes #}
      {% include "activities/includes/timesince.html" with timestamp=message.created owner=message.sender %}
    </div>
  </div>
  <div class="card-body">
    <div class="markdown-content">
      {{ message.message.markdown|truncatewords_html:60 }}
    </div>
  </div>
  {% if not message.read %}
  <div class="card-footer">
    <div class="actions">
      <a href="">Mark As Read</a>
      <a href="{% url 'conversations:conversation' message.sender.username %}">Reply</a>
    </div>
  </div>
  {% endif %}
</div>
{% endfor %}

{% include "includes/pagination.html" %}
{% else %}
{% include "includes/empty.html" %}
{% endif %}
{% endblock message_list %}
