{# Copyright (c) 2020 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "hashtags/base.html" %}
{% load i18n %}
{% load rules %}

{% block subtitle %}{{ block.super }} / #{{ tag.name }}{% endblock %}

{% block content %}

<ul class="breadcrumbs mb-3">
  <li class="breadcrumb-item"><a href="{% url 'hashtags:list' %}">{% trans "Tags" %}</a></li>
  <li class="breadcrumb-item">{{ tag.name }}</li>
</ul>

{% has_perm "users.follow_tag" user as can_follow_tag %}
{% has_perm "users.block_tag" user as can_block_tag %}

{% if can_follow_tag or can_block_tag %}
<div class="page-nav mb-3">
  {% if can_follow_tag %}
  <span data-controller="ajax"
        data-ajax-replace
        class="page-nav-item">
    {% with user.following_tags.all|contains:tag as is_following %}
    {% include "hashtags/includes/follow.html" with object=tag %}
    {% endwith %}
  </span>
  {% endif %}

  {% if can_block_tag %}
  <span data-controller="ajax"
        data-ajax-replace
        class="page-nav-item">
    {% with user.blocked_tags.all|contains:tag as is_blocked %}
    {% include "hashtags/includes/block.html" with object=tag %}
    {% endwith %}
  </span>
  {% endif %}
</div>
{% endif %}

{% with total=paginator.count %}
{% if total %}
<div class="notification">
  {% blocktrans with name=tag.name count counter=total %}
  <strong>One activity</strong> has been tagged with <strong>#{{ name }}</strong>.
  {% plural %}
  <strong>{{ total }} activities</strong> have been tagged with <strong>#{{ name }}</strong>.
  {% endblocktrans %}
</div>
{% endif %}
{% endwith %}

{% include "activities/includes/activity_list.html" %}
{% endblock content %}
