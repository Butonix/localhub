{% extends "join_requests/base.html" %}
{% load i18n %}

{% block content %}

<h3>{% trans "Requests to join this community" %}</h3>

<p>
  {% if view.show_all %}
  <a href="{{ request.path }}">{% trans "Show pending requests only" %}</a>
  {% else %}
  <a href="{{ request.path }}?all">{% trans "Show All" %}</a>
  {% endif %}
</p>
{% if object_list %}
<table class="table table-striped table-hover table-responsive-md">
  <thead>
    <tr>
      <th>{% trans "User" %}</th>
      <th>{% trans "Email" %}</th>
      <th>{% trans "Status" %}</th>
      <th>{% trans "Received" %}</th>
      <th>{% trans "Actions" %}</th>
    </tr>
  </thead>
  <tbody>
    {% for join_request in object_list %}
    <tr>
      <td>
        {% if join_request.sender %}
        {% include "users/includes/chip.html" with profile=join_request.sender %}
        {% else %}
        -
        {% endif %}
      </td>
      <td>{{ join_request.sender.email|default:join_request.email }}</td>
      <td>{{ join_request.get_status_display }}</td>
      <td>{{ join_request.created|date }}</td>
      <td>
        {% if join_request.is_pending %}
        <a class="btn btn-sm"
           data-controller="ajax"
           data-action="ajax#post"
           href="{% url 'join_requests:accept' join_request.id %}">{% trans "Accept" %}
        </a>
        <a class="btn btn-sm"
           data-controller="ajax confirm"
           data-action="confirm#check ajax#post"
           data-confirm-header="{% trans 'Reject' %}"
           data-confirm-body="{% trans 'Are you sure you want to reject this request?' %}"
           href="{% url 'join_requests:reject' join_request.id %}">{% trans "Reject" %}</a>
        {% else %}
        <a class="btn btn-sm disabled" href="#">{% trans "Accept" %}</a>
        <a class="btn btn-sm disabled" href="#">{% trans "Reject" %}</a>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% include "includes/pagination.html" %}
{% else %}
<div class="empty">
  <p class="empty-title h5">{% block empty %}{% trans "There are no requests at the moment" %}{% endblock %}</p>
</div>
{% endif %}
{% endblock content %}
