{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "invites/base.html" %}
{% load i18n %}
{% load rules %}

{% block content %}

<h3>{% trans "Invites" %}</h3>

<div class="actions">
    {% if total_count %}
    {% if status %}
    <a href="{{ request.path }}">{% trans "Show All" %}</a>
    {% endif %}
    {% for value, label in status_choices %}
    {% if status == value %}
    <b>{{ label }}</b>
    {% else %}
    <a href="{{ request.path }}?status={{ value }}">{{ label }}</a>
    {% endif %}
    {% endfor %}
    {% endif %}
    <a href="{% url 'invites:create' %}">
        {% trans "Send an invite" %}
    </a>
    <a href="{% url 'join_requests:list' %}">
        {% trans "Join Requests" %}
    </a>
    <a href="{% url 'communities:membership_list' %}">{% trans "Memberships" %}</a>
</div>

<div class="divider"></div>

{% if paginator.count or view.search_query %}
{% include "includes/forms/search_form.html" %}
{% endif %}

{% if object_list %}
<table class="table table-striped table-hover table-responsive-md mt-1">
    <thead>
        <tr>
            <th>{% trans "Email" %}</th>
            <th>{% trans "Status" %}</th>
            <th>{% trans "Actions" %}</th>
        </tr>
    </thead>
    <tbody>
        {% for invite in object_list %}
        <tr>
            <td>
                {{ invite.email }}
                <div class="info">
                    {% blocktrans with created=invite.sent|timesince %}
                    {{ created }} ago
                    {% endblocktrans %}
                </div>

            </td>
            <td>{{ invite.get_status_display }}</td>
            <td>
                <div class="actions">
                    {% if invite.is_pending %}
                    <a href="{% url 'invites:resend' invite.id %}"
                       class="d-hide"
                       data-controller="js-toggle ajax"
                       data-action="ajax#post">{% trans "Re-send" %}</a>
                    {% endif %}
                    {% url 'invites:delete' invite.id as delete_url %}
                    <a href="{{ delete_url }}"
                       data-controller="ajax confirm"
                       data-action="confirm#check ajax#post"
                       data-confirm-header="{% trans 'Delete invite' %}"
                       data-confirm-body="{% trans 'You sure you want to delete this invite?' %}">{% trans "Delete" %}</a>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
{% include "includes/empty.html" %}
{% endif %}


{% endblock content %}