{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% load i18n %}
{% load rules %}

{% has_perm "activities.change_activity" user photo as can_change_photo %}
{% has_perm "activities.delete_activity" user photo as can_delete_photo %}
{% has_perm "activities.like_activity" user photo as can_like_photo %}
<div class="btn-group">

  <a class="btn btn-sm btn-primary"
     href="{{ photo.image.url }}"
     download>
    <i class="icon icon-download"></i> {% trans "Download" %}
  </a>

  {% if can_like_photo %}
  <a href="#"
     id="like-photo-{{ photo.id }}"
     class="btn btn-sm"
     data-controller="ajax"
     data-action="ajax#post"
     {% if photo.has_liked %}
     data-ajax-url="{% url 'photos:dislike' photo.id %}"
     {% else %}
     data-ajax-url="{% url 'photos:like' photo.id %}"
     {% endif %}
     data-ajax-redirect="{{ request.get_full_path }}#like-photo-{{ photo.id }}"
     >
     {% if photo.has_liked %}
     <i class="icon icon-cross"></i> {% trans "Unlike" %}
     {% else %}
     <i class="icon icon-check"></i> {% trans "Like" %}
     {% endif %}
  </a>
    {% endif %}

    {% if can_change_photo %}
    <a class="btn btn-sm"
       href="{% url 'photos:update' photo.id %}">
      <i class="icon icon-edit"></i> {% trans "Update" %}
    </a>
    {% endif %}

    {% if can_delete_photo %}
    {% url 'photos:delete' photo.id as delete_url %}
    <a href="{{ delete_url }}"
       class="btn btn-sm"
       data-controller="ajax confirm"
       data-action="confirm#check ajax#delete"
       data-ajax-url="{{ delete_url }}"
       data-confirm-header="{% trans 'Delete Photo' %}"
       data-confirm-body="{% trans 'Are you sure you want to delete this photo?' %}"
       ><i class="icon icon-delete"></i> {% trans "Delete" %}</a>
    {% endif %}

</div>
