{# Copyright (c) 2020 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/base.html" %}
{% load i18n %}
{% load rules %}
{% load thumbnail %}

{% block subtitle %} / {% trans "Photos" %} / {% trans "Gallery" %}{% endblock %}

{% block content %}

<h1 class="page-header">{% trans "Gallery" %}</h1>

<div class="actions mb-1">
  {% has_perm 'activities.create_activity' user community as can_create_activity %}
  {% if can_create_activity %}
  <a class="action"
     href="{% url 'photos:create' %}">
    {% trans "Submit Photo" %}
  </a>
  {% endif %}
  <a class="action"
     href="{% url 'photos:list' %}">{% trans "Photos" %}</a>
</div>

<div class="divider"></div>

{% if page_obj.number > 1 %}
{% include "includes/pagination.html" with css_class="mt-1 mb-2" %}
{% endif %}

<div class="container">
  <div class="columns">
    {% for photo in object_list %}
    <div class="photo-gallery {{ forloop.counter|divisibleby:4|yesno:"pr-0,pr-1" }} pl-0 column col-sm-12 col-md-6 col-3 mb-2">
      <a href="{{ photo.get_absolute_url }}"
         title="{{ photo.title }}">
        {% if photo.image|is_portrait %}
        {% thumbnail photo.image "300x200" upscale=False crop="top" as image %}
        {% include "photos/includes/image.html" with title=photo.title %}
        {% endthumbnail %}
        {% else %}
        {% thumbnail photo.image "300" upscale=False as image %}
        {% include "photos/includes/image.html" with title=photo.title %}
        {% endthumbnail %}
        {% endif %}
      </a>
    </div>
    {% empty %}
    {% include "includes/empty.html" %}
    {% endfor %}
  </div>
</div>
{% include "includes/pagination.html" %}
{% endblock %}