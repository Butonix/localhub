{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "notifications/base.html" %}
{% load i18n %}
{% load notifications_tags %}

{% block content %}

<div class="float-left-responsive">
  <h3>{% trans "Notifications" %}</h3>
</div>

{% if object_list %}
<div class="float-right-responsive d-hide"
     data-controller="js-toggle">
  <div class="dropdown">
    <a class="btn btn-default dropdown-toggle"
       tabindex="0">
      {% trans "Actions" %}
      <i class="icon icon-caret"></i>
    </a>
    <ul class="menu">
      {% if is_unread_notifications %}
      <li class="menu-item">
        <a href="{% url 'notifications:mark_all_read' %}"
           data-controller="ajax"
           data-action="ajax#post">{% trans "Mark All As Read" %}</a>
      </li>
      {% endif %}
      <li class="menu-item">
        <a href="{% url 'notifications:delete_all' %}"
           data-controller="confirm ajax"
           data-action="confirm#check ajax#post"
           data-confirm-header="{% trans 'Delete All' %}"
           data-confirm-body="{% trans 'Are you sure you want to delete all your notifications?' %}">{% trans "Delete All" %}</a>
    </ul>
    </li>
  </div>
</div>
{% endif %}
<div class="clearfix"></div>

<div class="divider"></div>

<p class="toast text-center my-2 d-hide"
   data-controller="cookie-notice"
   data-cookie-notice-name="notifications-emails">
  <button class="btn btn-clear float-right"
          data-action="cookie-notice#accept"></button>
  {% url 'user_update' as user_settings_url %}
  {% blocktrans %}You can enable emails for your notifications <a href="{{ user_settings_url }}">in your
    settings</a>.{% endblocktrans %}
</p>

{% notifications_subscribe_btn user community %}

{% if object_list %}

<table class="table table-hover table-responsive">
  <tbody>
    {% for notification in object_list %}
    <tr>
      <td>
        <div class="d-block">
          {% include "notifications/includes/notification.html" %}
          <br />
          <span class="timesince">
            {% blocktrans with created=notification.created|timesince %}
            {{ created }} ago from
            {% endblocktrans %}
          </span>
          {% include "users/includes/chip.html" with profile=notification.actor %}
          {% if not notification.is_read %}
          <div class="chip bg-primary">{% trans "New" %}</div>
          {% endif %}
        </div>
      </td>
      <td>
        <div class="float-right-responsive">
          {% include "notifications/includes/actions.html" %}
        </div>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% include "includes/pagination.html" %}
{% else %}
{% include "includes/empty.html" %}
{% endif %}
{% endblock %}
