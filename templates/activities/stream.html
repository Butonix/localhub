{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/base.html" %}
{% load i18n %}
{% load rules %}
{% block activities_content %}
{% has_perm 'activities.create_activity' user request.community as can_create_activity %}
{% if can_create_activity %}
<div class="btn-group btn-group-block">
    {% with next_url=request.full_path|urlencode %}
    <a href="{% url 'posts:create' %}?next={{ next_url }}" class="btn btn-primary">
        <i class="icon icon-link"></i> {% trans "Submit Post" %}
    </a>
    <a href="{% url 'events:create' %}?next={{ next_url }}" class="btn">
        <i class="icon icon-time"></i> {% trans "Submit Event" %}
    </a>
    <a href="{% url 'photos:create' %}?next={{ next_url }}" class="btn">
        <i class="icon icon-photo"></i> {% trans "Upload Photo" %}
    </a>
    {% endwith %}
</div>
<div class="divider"></div>

{% elif user.is_authenticated %}
<p class="bg-gray p-2 text-center">
    {% url 'join_requests:create' as join_request_url %}
    {% blocktrans %}You do not have permission to post to this site. You can send a request to join this community <a href="{{ join_request_url }}">here</a>.{% endblocktrans %}
</p>

{% else %}
<p class="bg-gray p-2 text-center">
    {% url 'account_login' as login_url %}
    {% blocktrans %}Please <a href="{{ login_url }}">sign in</a> to post content to this site.{% endblocktrans %}
</p>

{% endif %}

{% for activity in object_list %}
<div class="mt-2">
    {% include "activities/includes/activity.html" %}
</div>
{% empty %}
<p class="p-2 bg-gray text-center">
    {% trans "Nothing to show right now." %}
</p>
{% endfor %}


{% include "includes/pagination.html" %}
{% endblock activities_content %}
