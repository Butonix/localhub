{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/base.html" %}
{% load i18n %}
{% load rules %}

{% block subtitle %} | {% trans "Tags" %} | {{ tag.slug }}{% endblock %}
{% block content %}


<ul class="breadcrumb">
  <li class="breadcrumb-item"><a href="{% url 'activities:tag_list' %}">{% trans "Tags" %}</a></li>
  <li class="breadcrumb-item"><a href="#">{{ tag.slug }}</a></li>
</ul>

{% has_perm "users.follow_tag" user as can_follow_tag %}
{% has_perm "users.block_tag" user as can_block_tag %}

{% if can_follow_tag or can_block_tag %}
<div class="actions">
  {% if can_follow_tag %}
  {% if object in user.following_tags.all %}
  <a href="{% url 'activities:tag_unfollow' tag.slug %}"
     data-controller="ajax"
     data-action="ajax#post">
    {% trans "Unfollow" %}
  </a>
  {% else %}
  <a href="{% url 'activities:tag_follow' tag.slug %}"
     data-controller="ajax"
     data-action="ajax#post">
    {% trans "Follow" %}
  </a>
  {% endif %}
  {% endif %}
  {% if can_block_tag %}
  {% if tag in user.blocked_tags.all %}
  <a href="{% url 'activities:tag_unblock' tag.slug %}"
     data-controller="ajax"
     data-ajax-redirect="{{ request.path }}"
     data-action="ajax#post">
    {% trans "Unblock" %}
  </a>
  {% else %}
  <a href="{% url 'activities:tag_block' tag.slug %}"
     data-controller="ajax"
     data-ajax-redirect="{{ request.path }}"
     data-action="ajax#post">
    {% trans "Block" %}
  </a>
  {% endif %}
  {% endif %}
</div>
{% endif %}

{% with total=paginator.count %}
{% if total %}
<div class="toast text-center my-1">
  {% blocktrans count counter=total %}
  There is one post with this tag.
  {% plural %}
  There are {{ total }} posts with this tag.
  {% endblocktrans %}
</div>
{% endif %}
{% endwith %}

{% include "activities/includes/activities_list.html" %}
{% endblock content %}
