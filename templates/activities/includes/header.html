{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% load i18n %}
{% load rules %}

{% has_perm "communities.moderate_community" user community as can_moderate_community %}
{% if object.is_flagged and can_moderate_community %}
<div class="toast toast-warning text-center">
  <a href="{{ object.get_absolute_url }}">{% trans "This object has been flagged" %}</a>
</div>
{% endif %}

<div class="card-title h5">
  {% if object.is_reshare %}
  <div class="card-subtitle h6 text-gray">
    {% include "activities/includes/timesince.html" with timestamp=object.created owner=object.owner is_reshare=True %}
  </div>
  <blockquote>
    {% endif %}
    {% if is_detail and not object.is_reshare %}
    {{ object.title }}
    {% else %}
    <a href="{% if object.parent %}{{ object.parent.get_absolute_url }}{% else %}{{ object.get_absolute_url }}{% endif %}">{{ object.title|truncatechars:130 }}</a>
    {% endif %}
    {% if object.is_reshare %}
  </blockquote>
  {% endif %}
</div>
<div class="card-subtitle h6 text-gray">
  {% if object.parent %}
  <blockquote>
    {% include "activities/includes/timesince.html" with timestamp=object.parent.created owner=object.parent.owner %}
  </blockquote>
  {% elif not object.is_reshare %}
  {% include "activities/includes/timesince.html" with timestamp=object.created owner=object.owner %}
  {% endif %}
</div>

