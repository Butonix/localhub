{# Copyright (c) 2020 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "includes/forms/stimulusjs_form.html" %}

{% load i18n %}
{% load activities_tags %}
{% load users_tags %}

{% block form_fields %}
{% verbose_name view.model as object_name %}

{% with tags=community.get_content_warning_tags|safeseq %}
{% if tags %}

{% blocktrans with tags_joined=tags|join:", " count counter=tags|length asvar tags_notice %}
If you include the tag <b>{{ tags_joined }}</b> in your content, the {{ object_name }}
will be concealed by users with the appropriate settings.
{% plural %}
If you include the tags <b>{{ tags_joined }}</b> in your content, the {{ object_name }}
will be concealed by users with the appropriate settings.
{% endblocktrans %}

{% dismissable_notice user "content-warning-tags" tags_notice|safe css_class="my-2" %}

{% endif %}
{% endwith %}
{{ block.super }}
{% endblock form_fields %}
{% block form_buttons %}

{% if object.published %}

<button type="submit"
        name="submit"
        class="btn btn-primary">
  {% trans "Update" %}
</button>

{% elif object.id %}
<button type="submit"
        name="save_private"
        value="true"
        data-action="form#submit"
        class="btn btn-primary">
  {% trans "Keep Private" %}
</button>
<button type="submit"
        name="submit"
        class="btn btn-secondary"
        {% if object.id %}
        data-controller="confirm"
        data-action="confirm#check form#submit"
        data-confirm-header="{% trans 'Publish' %}"
        data-confirm-body="{% blocktrans trimmed %}Are you sure you want to publish this {{ object_name }}? You cannot reverse this action.{% endblocktrans %}"
        {% endif %}>
  {% trans "Publish" %}
</button>

{% else %}
<button type="submit"
        name="submit"
        class="btn btn-primary">
  {% trans "Publish" %}
</button>
<button type="submit"
        name="save_private"
        value="true"
        data-action="form#submit"
        class="btn btn-secondary">
  {% trans "Save Private" %}
</button>
{% endif %}

{% endblock form_buttons %}
