{# Copyright (c) 2019 by Dan Jacob #}
{# SPDX-License-Identifier: AGPL-3.0-or-later #}

{% extends "activities/base.html" %}
{% load i18n %}
{% load rules %}
{% block subtitle %} - {% trans "Posts" %}{% endblock %}
{% block content %}
{% has_perm 'activities.create_activity' user community as can_create_activity %}
{% if can_create_activity %}
<div class="float-right">
  <a href="{% url 'posts:create' %}" class="btn btn-sm">
    {% trans "Submit Post" %}
  </a>
</div>
<div class="clearfix"></div>

{% elif user.is_authenticated %}
<p class="toast text-center my-1">
  {% url 'join_requests:create' as join_request_url %}
  {% blocktrans %}You do not have permission to submit posts to this site. You can send a request to join this community <a href="{{ join_request_url }}">here</a>.{% endblocktrans %}
</p>

{% else %}
<p class="toast text-center my-1">
  {% url 'account_login' as login_url %}
  {% blocktrans %}Please <a href="{{ login_url }}?next={{ request.get_full_path }}">sign in</a> to submit posts to this site.{% endblocktrans %}
</p>

{% endif %}

<h3>{% trans "Posts" %}</h3>

{% include "includes/search_form.html" %}

{% for post in object_list %}
<div class="mt-1">
  {% include "posts/includes/post.html" %}
</div>
{% empty %}
<div class="empty mt-1">
  <p class="empty-title h5">
      {% if view.search_query %}
      {% trans "No posts have been found for your search." %}
      {% else %}
      {% trans "No posts have been submitted yet." %}
      {% endif %}
  </p>
</div>
{% endfor %}


{% include "includes/pagination.html" %}
{% endblock content %}
